(()=>{(function(e){"use strict";if(e(function(){p(),y();var t=document.querySelectorAll(".mc-main");t&&t.forEach(a=>{a.classList.remove("mcjs")})}),my_calendar.mini==="true"&&(e(".mini .calendar-events").hide(),e(document).on("click",".mini .has-events .trigger",function(t){t.preventDefault();var a=e(this).parents(".has-events").children(".calendar-events");a.toggle(),e(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(".mini .has-events").children().not(".mc-date-container").not(a).hide(),e(this).addClass("active-toggle"),t.stopImmediatePropagation()}),e(document).on("click",".calendar-events .close",function(t){t.preventDefault(),e(this).closest(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(this).closest("div.calendar-events").toggle(),t.stopImmediatePropagation()})),my_calendar.list==="true"&&my_calendar.links==="false"&&(e("li .list-event").hide(),e("li.current-day .list-event").show(),e("li.current-day .event-date .mc-text-button").attr("aria-expanded",!0),e(document).on("click",".event-date button",function(t){t.preventDefault(),console.log(e(this).closest(".mc-events").find(".mc-event")),e(this).closest(".mc-events").find(".mc-event").toggle();var a=e(this).closest(".mc-events").find(".mc-event").is(":visible");return a?e(this).attr("aria-expanded","true"):e(this).attr("aria-expanded","false"),t.stopImmediatePropagation(),!1})),my_calendar.grid==="true"||my_calendar.list==="true"&&my_calendar.links==="true"){var _=my_calendar.grid==="true"?".calendar-event":".list-event",v=my_calendar.links==="true"&&my_calendar.grid==="true"?".mc-events":_;e(v+" .single-details").hide(),e(document).on("click",v+" .event-title .open",function(t){var a=e(this).parents(".mc-event").children(".details").is(":visible"),r=e(this).attr("aria-controls"),n=e("#"+r);a?e(this).attr("aria-expanded","false"):e(this).attr("aria-expanded","true"),t.preventDefault();var s=e(this).parents(".mc-event").children();e(this).closest(".mc-main").toggleClass("grid-open"),n.toggle();var l=s.find("a, object, :input, iframe, [tabindex]"),o=l.last(),c=l.first();return c.attr("data-action","shiftforward"),o.attr("data-action","shiftback"),e(v).children(".single-details").not(s).hide(),t.stopImmediatePropagation(),!1}),e(document).on("click",".calendar-event .close",function(t){t.preventDefault(),e(this).parents(".mc-event").find("a.open").attr("aria-expanded","false"),e(this).closest(".mc-main").removeClass("grid-open"),e(this).closest(".mc-event").find(".event-title a").trigger("focus"),e(this).closest("div.single-details").toggle(),t.stopImmediatePropagation()}),e(document).on("keydown",function(t){var a=t.keyCode?t.keyCode:t.which;a==27&&(e(".mc-main ").removeClass("grid-open"),e(".calendar-event div.single-details").hide(),e(".mini .calendar-events").hide())}),e(document).on("keydown",".mc-event a, .mc-event object, .mc-event :input, .mc-event iframe, .mc-event [tabindex]",function(t){var a=t.keyCode?t.keyCode:t.which,r=e(":focus").attr("data-action");!t.shiftKey&&a==9&&r=="shiftback"&&(t.preventDefault(),e("[data-action=shiftforward]").trigger("focus")),t.shiftKey&&a==9&&r=="shiftforward"&&(t.preventDefault(),e("[data-action=shiftback]").trigger("focus"))})}if(my_calendar.ajax==="true"){var x=e(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)");x.each(function(){e(this).attr("role","button")}),e(document).on("keydown",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)",function(t){t.which===32&&t.preventDefault()}),e(document).on("click keyup",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit]",function(t){if(t.preventDefault(),t.type==="click"||t.type==="keyup"&&t.which===32){var a=e(this).attr("id"),r=e(this).closest(".mc-main"),n=r.attr("id"),s="",l="",o="",c="",f="",u="",m="";if(this.nodeName==="INPUT"){var d=e(this).parents("form");if(d.hasClass("mc-date-switcher"))var s=d.find("select[name=month]").val(),l=d.find("select[name=dy]").val(),o=d.find("select[name=yr]").val();if(d.hasClass("mc-categories-switcher"))var c=d.find("select[name=mcat]").val();if(d.hasClass("mc-locations-switcher"))var f=d.find("select[name=loc]").val();if(d.hasClass("mc-access-switcher"))var u=d.find("select[name=access]").val();var m=r.find("input[name=mcs]").val(),h=e(this).attr("data-href")}else var h=e(this).attr("href");let i;try{i=new URL(h),i.searchParams.delete("embed"),i.searchParams.delete("source"),this.nodeName==="INPUT"&&(s!==""&&(i.searchParams.delete("month"),i.searchParams.delete("dy"),i.searchParams.delete("yr"),i.searchParams.append("month",parseInt(s)),typeof l<"u"&&i.searchParams.append("dy",parseInt(l)),i.searchParams.append("yr",parseInt(o))),c!==""&&(i.searchParams.delete("mcat"),i.searchParams.append("mcat",c)),f!==""&&(i.searchParams.delete("loc"),i.searchParams.delete("ltype"),i.searchParams.append("ltype","id"),i.searchParams.append("loc",f)),u!==""&&(i.searchParams.delete("access"),i.searchParams.append("access",parseInt(u))),i.searchParams.delete("mcs"),m!==""&&typeof m<"u"&&i.searchParams.append("mcs",encodeURIComponent(m)),h=i.toString()),window.history.pushState({},"",i)}catch(w){i=!1}var k=r.height();e("#"+n).html('<div class="mc-loading"></div><div class="loading" style="height:'+k+'px"><span class="screen-reader-text">Loading...</span></div>'),e("#"+n).load(h+" #"+n+" > *",function(w,P,b){P=="error"&&e("#"+n).html(b.status+" "+b.statusText),typeof my_calendar<"u"&&my_calendar.list=="true"&&(my_calendar.links==="false"?(e("li.mc-events").find(".mc-events").hide(),e("li.current-day").children().show()):e("li.mc-events .single-details").hide()),typeof my_calendar<"u"&&my_calendar.grid=="true"&&e(".calendar-event").children().not("header").hide(),typeof my_calendar<"u"&&my_calendar.mini=="true"&&e(".mini .has-events").children().not(".mc-date-container").hide(),e("#"+a).trigger("focus");var A=e("#mc_head_"+n).text();wp.a11y.speak(A),p(),y(),g()})}})}function p(){var t=e(".mc-user-time");let a=Intl.DateTimeFormat().resolvedOptions().timeZone;t.each(function(){var r=e(this).text();a===void 0&&(a=e(this).attr("data-label")),r.replace("Z",".000Z")===new Date(r).toISOString()&&e(this).css({display:"none"});var n='<span class="mc-local-time-time">'+new Date(r).toLocaleTimeString().replace(":00 "," ")+"</span>",s='<span class="mc-local-time-date">'+new Date(r).toLocaleDateString()+"</span>";e(this).html('<span class="mc-local-time-label">'+a+":</span> "+s+'<span class="sep">, </span>'+n).attr("data-time",r)})}function y(){var t=e(".mc-subscribe"),a=e(".mc-download");if(t.length>0){var r="mc_control_"+Math.floor(Math.random()*1e3).toString(),n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("aria-controls",r),n.setAttribute("aria-expanded",!1),n.innerText=my_calendar.subscribe,t.find("ul").attr("id",r),t.find("ul").css({display:"none"}),t.prepend(n)}if(a.length>0){var r="mc_control_"+Math.floor(Math.random()*1e3).toString(),n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("aria-controls",r),n.setAttribute("aria-expanded",!1),n.innerText=my_calendar.export,a.find("ul").attr("id",r),a.find("ul").css({display:"none"}),a.prepend(n)}var s=e(".mc-export button");s.each(function(){e(this).on("click",function(l){var o=e(this).attr("aria-controls"),c=e("#"+o);c.is(":visible")?(c.css({display:"none"}),e(this).attr("aria-expanded","false")):(c.css({display:"block"}),e(this).attr("aria-expanded","true"))})})}e(".mc-main a[target=_blank]").append(' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>");function g(){try{for(var t=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),a=0;a<t.length;a++)t[a].setAttribute("role","table");for(var r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),a=0;a<r.length;a++)r[a].setAttribute("role","rowgroup");for(var n=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),a=0;a<n.length;a++)n[a].setAttribute("role","row");for(var s=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),a=0;a<s.length;a++)s[a].setAttribute("role","cell");for(var l=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),a=0;a<l.length;a++)l[a].setAttribute("role","columnheader");for(var o=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]"),a=0;a<o.length;a++)o[a].setAttribute("role","rowheader")}catch(c){console.log("my_calendar_table_aria(): "+c)}}g()})(jQuery);})();
